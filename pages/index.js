import Head from "next/head";
import Link from "next/link";
import Header from "../components/Header";
import React, { useEffect, useRef, useState } from "react";
import Image from "next/image";
import Release from "../components/Release";
import fort from "/assets/share/Subtract.png";
import Reviews from "../components/Reviews";
import soa from "/assets/share/soa.png";
import vittorio from "/assets/share/vb.png";
import trinity from "/assets/share/ljt.png";
import Footer from "../components/Footer";
import Menu from "../components/Menu";
import Process from "../components/Process";
import gsap from "gsap";

const Forest = () => {
  return (
    <section className="forest_container">
      <Image src={fort} alt="alt" />
    </section>
  );
};

const Customers = () => {
  const customersContainerRef = useRef(null);
  const titleRef = useRef(null);
  const icon1Ref = useRef(null);
  const icon2Ref = useRef(null);
  const icon3Ref = useRef(null);

  useEffect(() => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          animateElements();
          observer.unobserve(entry.target);
        }
      });
    });

    observer.observe(customersContainerRef.current);
  }, []);

  function animateElements() {
    gsap.fromTo(
      titleRef.current,
      { y: 70 },
      {
        y: 0,
        opacity: 1,
        ease: "power2.out",
      }
    );

    const icons = [icon1Ref, icon2Ref, icon3Ref];
    icons.forEach((icon, index) => {
      gsap.fromTo(
        icon.current,
        { y: 70 },
        {
          delay: index * 0.2,
          y: 0,
          opacity: 1,
          ease: "power2.out",
        }
      );
    });
  }

  return (
    <section ref={customersContainerRef} className="customers">
      <div className="customers_container">
        <div className="hidden">
          <h2 ref={titleRef}>Nos Clients</h2>
        </div>
        <ul className="customers_content">
          <li>
            <Image ref={icon1Ref} src={vittorio} alt="alt" />
          </li>
          <li>
            <Image ref={icon2Ref} src={soa} alt="alt" />
          </li>
          <li>
            <Image ref={icon3Ref} src={trinity} alt="alt" />
          </li>
        </ul>
      </div>
    </section>
  );
};

const Contact = () => {
  return (
    <section className="contact">
      <div className="contact_content">
        <p>
          <span>Impressionnez par notre travail?</span>
          <span>Contactez-nous maintenant</span>
        </p>
        <button>Nous Contacter</button>
      </div>
    </section>
  );
};

function Home() {
  const [openMenu, setOpenMenu] = useState(false);
  return (
    <>
      <Head>
        <title>DÃ©cor Ta Kaz | Menuiserie Artisanale</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Header setOpenMenu={setOpenMenu} openMenu={openMenu} />
      {openMenu && <Menu setOpenMenu={setOpenMenu} openMenu={openMenu} />}

      <main className="main">
        <Release />
        <Process />
        <Forest />
        <Customers />
        <Reviews />
        <Contact />
        <Footer />
      </main>
    </>
  );
}

export default Home;
